<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ASSAA</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gugi&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link href="//cdn.jsdelivr.net/npm/@sweetalert2/theme-default@4/default.css" rel="stylesheet">


  <style>
    .ml6 {
      position: relative;
      font-weight: 900;
      font-size: 4.3em;
      text-align: center;
      color: black;
    }

    .ml6 .text-wrapper {
      position: relative;
      display: inline-block;
      padding-top: 1.6em;
      padding-right: 0.05em;
      padding-bottom: 0.1em;
    }

    .ml6 .letter {
      display: inline-block;
      line-height: 0.9em;
    }

    * {
      font-family: 'Gugi', cursive;
    }

    #modalButton2 {
      margin-top: 20px;
    }

    html {
      background-size: cover;
      background-color: antiquewhite;
    }

    .navbar {
      background-color: antiquewhite;
    }

    #submitEmail {
      margin-bottom: 10px;
    }

    .button {
      font-family: 'Gugi', cursive;

    }
    #mailAuthVerify{
      margin-top:10px;
    }
    #errormsg,#emailError,#passwordCheckError,#authError{
      color:red;
      display: none;
    }
    #greeting{
      display:none;
    }

  </style>
</head>

<body>
  <section class="section">
    <div class="container">
      <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
          <a class="navbar-item" href="/">
            <img src="/bulma-logo (1).png" width="112" height="28"> 
            <!-- ë¡œê³  ë“¤ì–´ê° -->
          </a>
      </nav>
      <h1 class="ml6">
        <span class="text-wrapper">
          <span class="letters">í•œê²½ì´ì˜ë³´ì´ìŠ¤í†¡</span>
        </span>
      </h1>
     
      
      <article class="message" data-aos="zoom-in" id="greeting">
        <div class="message-body">
          <strong>ê°€ì…í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤</strong>
          <p>ì‚¬ìš©ìê°„ ìš•ì„¤ê³¼ ë¹„ë°©ì€ ì‚¼ê°€í•´ì£¼ì‹­ì‹œì˜¤</p>
        </div>
      </article>
      <button class="button is-warning is-large is-fullwidth is-rounded" style="margin-bottom: 10px;" id="modalButton2">ì‹œì‘í•˜ê¸°</button>

      <button class="button is-success is-large is-fullwidth is-rounded" id="modalButton1">íšŒì›ê°€ì…</button>


    </div>
  </section>
<!-- íšŒì›ê°€ì… ëª¨ë‹¬ì„ -->
  <div class="modal" id="modal1" >
    <div class="modal-background"></div>
    <div class="modal-card is-success">
      <header class="modal-card-head">
        <p class="modal-card-title">hknu.ac.kr ì´ë©”ì¼ë¡œ ì¸ì¦</p>
        <button class="delete" aria-label="close"></button>
      </header>
      <section class="modal-card-body">
        <div class="container">
          <form class="register" id="register" action="/" method="POST" > 
            <!-- form = ì„œë²„ì— ë³´ë‚´ëŠ” ë°ì´í„°ë“¤ì„ -->
            <div class="field">
              <label class="label">ì´ë©”ì¼</label>
              <div class="control">
                <input class="input" type="email" placeholder="email input" name="email" id="email" value=""  required>
              </div>
            </div>
            <p id="emailError"></p>
            <span>
              <button type="button" class="button is-warning is-small is-rounded" id="mailAuthSend">ì¸ì¦ìš”ì²­</button>
              <!-- <button type ="button" class="button is-warning is-small is-rounded" id="mailAuthSend2">ì¸ì¦ìš”ì²­22</button> -->
              <p id ="mailMessage"></p>
            </span>
            <div class="field">
              <label class="label">ì¸ì¦ ë²ˆí˜¸</label>
              <div class="control">
                <input class="input" type="number" placeholder="secret number" name="authCode" id="authCode" required>
                <button type ="button"class="button is-warning is-small is-rounded" id="mailAuthVerify">ì¸ì¦í™•ì¸</button>
              </div>
            </div>
            <p id="authError"></p>
            <div class="field">
              <label class="label">ë‹‰ë„¤ì„</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input" type="text" placeholder="Text input" id="nickName" value='' required
                  name="nickName">
                <span class="icon is-small is-left">
                  <i class="fas fa-user"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-check"></i>
                </span>
              </div>
            </div>


            <div class="field">
              <label class="label">ë¹„ë°€ë²ˆí˜¸</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input" type="password" placeholder="password" value="" id="password" name="password" required>
                <span class="icon is-small is-left">
                  <i class="fas fa-envelope"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-exclamation-triangle"></i>
                </span>
              </div>
            </div>

            <div class="field">
              <label class="label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input" type="password" placeholder="password" value="" id="passwordCheck" required>
                
                <span class="icon is-small is-left">
                  <i class="fas fa-envelope"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-exclamation-triangle"></i>
                </span>
              </div>
            </div>
            <p id="passwordCheckError"></p>

            <div class="field">
              <label class="label" required>ë‹¹ì‹ ì˜ í•™ë²ˆì€??</label>
              <div class="control">
                <div class="select">
                  <select name="studentId" id="studentId">
                    <option>í™”ì„</option>
                    <option>20í•™ë²ˆ</option>
                    <option>21í•™ë²ˆ</option>
                    <option>22í•™ë²ˆ</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="field">
              <label class="label" required>ë‹¹ì‹ ì˜ ì„±ë³„ì€??</label>
              <div class="control">
                <div class="select">
                  <select name="gender" id="gender">
                    <option>ë‚¨ì</option>
                    <option>ì—¬ì</option>
                    <option>ì¤‘ì„±</option>
                   
                  </select>
                </div>
              </div>
            </div>

            <div class="field">
              <label class="label" required>ë‹¹ì‹ ì˜ MBTIëŠ”??</label>
              <div class="control">
                <div class="select">
                  <select name="mbti" id="mbti">
                    <option>ISTJ</option>
                    <option>ISFJ</option>
                    <option>INFJ</option>
                    <option>INTJ</option>
                    <option>ISTP</option>
                    <option>ISFP</option>
                    <option>INFP</option>
                    <option>INTP</option>
                    <option>ESTP</option>
                    <option>ESFP</option>
                    <option>ENFP</option>
                    <option>ENTP</option>
                    <option>ESTJ</option>
                    <option>ESFJ</option>
                    <option>ENFJ</option>
                    <option>ENTJ</option>
                  </select>
                </div>
              </div>
            </div>

        

            <div class="field">
              <label class="label">í•œ ì¤„ ìê¸°ì†Œê°œ</label>
              <div class="control">
                <textarea class="textarea" placeholder="ìì‹ ì˜ ì·¨ë¯¸ë‚˜ ì·¨í–¥ MBTIë“± ìê¸°ë¥¼ ì†Œê°œ í•  ë§Œí•œ ë¬´ì—‡ì´ë“  ì¢‹ì•„ìš”" required
                  name="selfIntroduce" id="selfIntroduce"></textarea>
              </div>
            </div>

            <div class="field">
              <div class="control">
                <label class="checkbox">
                  <input type="checkbox">
                  I agree to the <a href="#">terms and conditions</a>
                  
                </label>
                <p id ="passwordCheckMessage"></p>
              </div>
            </div>

            
            <button type="submit" class="button is-link is-success" id="registerButton">ê°€ì…í•˜ê¸°</button>
          </form>
          <!-- form ëë‚¨ -->
        </div>
      </section>
    </div>
  </div>
  <!-- íšŒì›ê°€ì… ëª¨ë‹¬ ëë‚¨ -->

  <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ì„ -->
  <div class="modal " id="modal2" >
    <div class="modal-background"></div>
    <div class="modal-card">
      <form class="loginForm" action="/login" method="POST">
      <header class="modal-card-head">
        <p class="modal-card-title">ë°˜ê°‘ìŠµë‹ˆë‹¤ğŸ˜</p>
        <button class="delete" aria-label="close"></button>
      </header>
      <section class="modal-card-body">
        <div class="field">
          <label class="label">ì´ë©”ì¼</label>
          <div class="control has-icons-left has-icons-right">
            <input class="input is-success" type="email" placeholder="Email" value="@hknu.ac.kr" name="loginEmail">
            <span class="icon is-small is-left">
              <i class="fas fa-envelope"></i>
            </span>
            <span class="icon is-small is-right">
              <i class="fas fa-exclamation-triangle"></i>
            </span>
          </div>
          <label class="checkbox">
            <input type="checkbox">
            ì´ë©”ì¼ ê¸°ì–µí•˜ê¸°
          </label>

        </div>

        <div class="field">
          <label class="label">ë¹„ë°€ë²ˆí˜¸</label>
          <div class="control has-icons-left has-icons-right">
            <input class="input is-success" type="password" placeholder="password" value="" name="loginPassword">
            <span class="icon is-small is-left">
              <i class="fas fa-envelope"></i>
            </span>
            <span class="icon is-small is-right">
              <i class="fas fa-exclamation-triangle"></i>
            </span>
          </div>
          <a class="help is-warning" href="/findPassword">ë¹„ë°€ë²ˆí˜¸ê°€ ê¸°ì–µì´ ë‚˜ì§€ ì•Šë‚˜ìš”? </a>
          <button type="submit" id="loginButton" class="button is-success">ë¡œê·¸ì¸</button>
          <button type="button" id="guestButton" class="button is-warning">ê²ŒìŠ¤íŠ¸ë¡œ ì…ì¥í•˜ê¸°</button>

          <p id="errormsg"><%=error%></p>

        </div>
      </section>
    </form>
    </div>
  </div>
  <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ ëë‚¨ -->
  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
  <script src="/bulmaModal.js"></script>
  <script src="/textAnime.js"></script>
  <script src="/randomName.js"></script>
  <script src="/app.js"></script>
  <!-- JQuery CDN: https://releases.jquery.com/ -->
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>


  <script>
    let username;
    console.log(new Date());
    // let password = document.querySelector("#password");
    // let passwordCheck = document.querySelector("#passwordCheck");
    // let passwordCheckError = document.querySelector("#passwordCheckError");
    let register = document.querySelector("#register");
    register.addEventListener('submit',(event)=>{
      if(authChecked&&passwordChecked){
        return true;
      }
      else{
        alert("ë¹ ëœ¨ë¦°ê±´ ì—†ë‚˜ìš”");
        event.preventDefault();
      }
    })
    let authChecked = 0;
    let passwordChecked = 0;
    let isOkay = '<%=isOkay%>';
    let error = '<%=error%>';
    let errormsg = document.querySelector("#errormsg");
    let greeting = document.querySelector("#greeting");
    const guestButton = document.querySelector('#guestButton');

    guestButton.addEventListener('click',()=>{
        Swal.fire({
        icon: 'warning',
        title: 'ì£¼ì˜ í•´ì£¼ì„¸ìš”',
        input:'text',
        inputLabel: 'ë‹¹ì‹ ì´ ì‚¬ìš©í•  ë‹‰ë„¤ì„ì€?',
        inputPlaceholder: 'your nickname',
        text: 'ì‚¬ìš©ìê°„ ìš•ì„¤ê³¼ ë¹„ë°©ì€ ì‚¼ê°€í•´ì£¼ì„¸ìš”!',
        confirmButtonText: 'ì‹œì‘í•˜ê¸°',
        inputValidator: (value) => {
          if (!value) {
            return 'ë‹‰ë„¤ì„ ì ì–´ì£¼ì„¸ìš”!'
          }
        }
      }).then((result)=>{
        if(result.isConfirmed){
          localStorage.setItem('name',JSON.stringify(result.value));
          location.href='/mainNologin';
        }
        else{
          console.log('it was closed');
        }
      })

    })

    if(isOkay== 'false'){ // ë¡œê·¸ì¸ ì‹¤íŒ¨ ê²½ìš°ì„
      errormsg.style.display='block';
      errormsg.innerHTML=error;
      modal2.classList.add('is-active');
    }
    if(error=='none'){
      greeting.style.display='block';
      errormsg.style.display='none';
    }
        AOS.init({ duration: 1200 }); // AOS ëª¨ë“ˆ ê°€ì ¸ì˜¨ê±° ì‹¤í–‰í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì„

      

    $("#mailAuthSend").click( ()=> {   //ë©”ì¼ ë³´ë‚´ê¸° ë²„íŠ¼ í´ë¦­í–ˆì„ë•Œì„
      //í˜„ì¬ ì˜ëª»ëœ ë©”ì¼ ì ìœ¼ë©´ ì„œë²„ í¬ë˜ì‰¬ëœ¨ê³  ì¢…ë£Œë¨
      const email = $("#email").val();
      if(email.indexOf('@') == -1 || email.indexOf('hknu.ac.kr') == -1){
        const emailError = document.querySelector("#emailError");
        emailError.style.display='block';
        emailError.innerHTML='í•œê²½ëŒ€ ì´ë©”ì¼ë¡œ ì…ë ¥í•˜ì„¸ìš”'
      }
      else{
        emailError.innerHTML=''
      $("#mailAuthSend").attr('disabled',''); // ëˆ„ë¥´ë©´ ë²„íŠ¼ disabledë¨
      
      $.ajax({ // ì œì´ì¿¼ë¦¬ ë¬¸ë²•ìœ¼ë¡œ xmlHttpRequest ë³´ë‚´ëŠ”ê±°ì„ = AJAX ì½œì„
        
        method: "POST",
        url: "/mailAuth",
        data: {
          email: email
        }
        
      
      }).done(function (data) {
        // $(this).addClass("done");
        // console.log("ìš”ì²­ í™•ì¸");
        const { error } = data;
        const { authCode } = data;
        const msg = document.querySelector("#mailMessage");
        if(error){
          msg.innerHTML=`${error}`
          msg.style.color='red';
          $("#mailAuthSend").removeAttr('disabled'); 

        }
        else{
        msg.innerHTML="ì½”ë“œê°€ ì „ì†¡ ë˜ì—ˆìŠµë‹ˆë‹¤."
        msg.style.color='black';
        }
        
        


        
                
        $("#mailAuthVerify").click( ()=>{  
        const userCode = $("#authCode").val();
        console.log(userCode);
        console.log(authCode);
        if(userCode == authCode){ // ì‚¬ìš©ìê°€ ì œëŒ€ë¡œ ë°›ì•„ ì ì—ˆëŠ”ì§€ ê²€ì‚¬í•¨
          const bt = document.querySelector("#mailAuthVerify");
          const authCode = document.querySelector("#authCode");
          bt.classList.remove("is-warning");
          bt.classList.add("is-success");
          bt.setAttribute("disabled","");
          authCode.setAttribute("readonly","") //ì¸ì¦í•˜ë©´ ì½”ë“œ ìˆ˜ì • ëª»í•˜ê²Œ readoonly ì†ì„± ë‹¬ìŒ
          alert('ì¸ì¦ì™„ë£Œ');
          authChecked=1;
          
        }
        else{
          let authError = document.querySelector("#authError");
          authError.innerHTML='ì¸ì¦ë²ˆí˜¸ í™•ì¸ì¢€'
        }
        
    })

      })};
    

    });

    setInterval(checkPassword,1000);
    function checkPassword(){
      if(password.value==passwordCheck.value){
      passwordChecked=1;
      if(passwordChecked==1){
        passwordCheckError.innerHTML='ë¹„ë²ˆ ì¼ì¹˜í•¨';
        passwordCheckError.style.color='green';        
      }
      
    }
    else{
      passwordChecked=0;
      if(passwordChecked==0){
        passwordCheckError.style.display='block';
      passwordCheckError.innerHTML='ë¹„ë²ˆ í™•ì¸ì¢€'
      passwordCheckError.style.color='red';
      }
      
    }
  }
    
    
  // // ì´ê±° ì“°ë ¤ë©´ íšŒì›ê°€ì… form íƒœê·¸ ì•ˆì— method = 'POST' action = "/" ì§€ìš°ê³  í•˜ì…ˆ 
  // // ê·¸ë¦¬ê³  ì‹œì‘í•˜ê¸° ë²„íŠ¼ì— type="button" ë„£ì–´ì¤˜ì•¼ëŒ
  // // submitì´ ì•„ë‹ˆë¼ì„œ íƒœê·¸ì•ˆì— required ì†ì„± ë¬´ì‹œë¨ 
  //   $("#registerButton").click( ()=>{ // ê°€ì…í•˜ê¸° ë²„íŠ¼ ëˆŒë €ì„ ë•Œì„

  //     const email = $("#email").val();
  //     const nickName = $("#nickName").val();
  //     const password = $("#password").val();
  //     const passwordCheck = $("#passwordCheck").val();
  //     const studentId = $("studentId").val();
  //     const gender = $("#gender").val();
  //     const selfIntroduce = $("#selfIntroduce").val();
  //     const passwordCheckMessage = $("#passwordCheckMessage");

      
  //     if(password == passwordCheck&&password != ''&&passwordCheck !=''){ 
  //       //// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ê²€ì‚¬ì„ ê°œì„ í•´ì•¼ë¨ ğŸ˜
        
        
  //     $.ajax({ // ì œì´ì¿¼ë¦¬ ë¬¸ë²•ìœ¼ë¡œ xmlHttpRequest ë³´ë‚´ëŠ”ê±°ì„ = AJAX ì½œì„
  //       method: "POST",
  //       url: "/",
  //       data: {
  //         email: email,
  //         nickName : nickName,
  //         password : password,
  //         studentId : studentId,
  //         gender : gender,
  //         selfIntroduce : selfIntroduce
  //       }
  //   })
  //   .done(function(data){
  //       console.log("ê°€ì…í•¨");
        
  //   })
  // }
  // else{
  //   alert("ë¹„ë°€ë²ˆí˜¸ í™•ì¸í•˜ì…ˆ");
  // }
  // })

  

  
  

   

    
  </script>
</body>

</html>